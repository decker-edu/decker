<!DOCTYPE html>
<html$if(lang)$ lang="$lang$" $endif$$if(dir)$ dir="$dir$" $endif$>

  <head>
    <meta charset="utf-8">
    <meta name="generator" content="pandoc">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"> $for(author-meta)$
    <meta name="author" content="$author-meta$"> $endfor$ $if(date-meta)$
    <meta name="dcterms.date" content="$date-meta$"> $endif$ $if(keywords)$
    <meta name="keywords" content="$for(keywords)$$keywords$$sep$, $endfor$"> $endif$
    <meta name="apple-mobile-web-app-capable" content="yes">
$if(template.favicon)$
    <link rel="shortcut icon" href="$template.favicon$">
$endif$
    <title>$if(title-prefix)$$title-prefix$ – $endif$$pagetitle$</title>
    <style type="text/css">
      code {
        white-space: pre;
      }
    </style>
    $if(quotes)$
    <style type="text/css">
      q {
        quotes: "“""”""‘""’";
      }
    </style>
    $endif$
    $if(highlighting-css)$
    <style type="text/css">
      $highlighting-css$
    </style>
    $endif$

$if(template.base-css)$
    <link rel="stylesheet" href="$template.base-css$">
$else$
    <link rel="stylesheet" href="$decker-support-dir$/css/page.css">
$endif$

<!-- Transfer meta data values from keys `palette.colors` and `css-variables`
  into a style sheet. Default values can come from `variables.css`. -->
  <style class="css-declarations">
   :root {
     $for(css-light-colors/pairs)$
       --light-$it.key$: $it.value$;
     $endfor$
     $for(css-dark-colors/pairs)$
       --dark-$it.key$: $it.value$;
     $endfor$
   }
   @media (prefers-color-scheme: light) {
     :root {
       $for(css-light-color-declarations)$
         $css-light-color-declarations$
       $endfor$
     }

     :root.dark {
       $for(css-dark-color-declarations)$
         $css-dark-color-declarations$
       $endfor$
     }
   }
   @media (prefers-color-scheme: dark) {
     :root {
       $for(css-dark-color-declarations)$
         $css-dark-color-declarations$
       $endfor$
     }

     :root.light {
       $for(css-light-color-declarations)$
         $css-light-color-declarations$
       $endfor$
     }
   }
   :root {
     $for(css-declarations)$
       $css-declarations$
     $endfor$
   }
 </style>
 
    <script>
      var socket = new WebSocket("ws://" + location.host + "/reload");
      socket.onmessage = function (event) {
        if (event.data.startsWith("reload!")) 
          window.location.reload(true);
      };
    </script>

    $for(header-includes)$
    $header-includes$
    $endfor$
    $for(template.css)$
    <link rel="stylesheet" href="$template.css$">
    $endfor$
  </head>

  <body class="document page" onload="initPage();">
    $for(include-before)$
    $include-before$
    $endfor$

    <header>
    $if(template.index-page.banner)$
    <div class="index-page-banner">
       <img src=$template.index-page.banner$>
    </div>
    $endif$
    $if(title)$
      <h1>$title$</h1>
      $if(subtitle)$
      <h2>$subtitle$</h2>
      $endif$
    $endif$
    </header>

    $if(toc)$
    $if(toc-title)$
    <h1 id="$idprefix$TOC-title class="toc-title">$toc-title$</h1>
    $endif$
    <nav id="$idprefix$TOC">
        $table-of-contents$
    </nav>
    $endif$

<!-- body must not be indented or code blocks render badly -->
<!-- The following line must be left aligned! -->
$body$
<!-- The previous line must be left aligned! -->

    <script src="$decker-support-dir$/vendor/js/jquery.min.js" type="text/javascript"></script>
    <script src="$decker-support-dir$/vendor/js/lazyload.min.js" type="text/javascript"></script>
    <script src="$decker-support-dir$/js/page.js"></script>
    <script type="module" src="$decker-support-dir$/js/page-math.js"></script>

    $for(include-after)$
    $include-after$
    $endfor$
    $if(author)$
    <hr>
    <address>
      $if(date)$
      <p id="date">$date$</p>
      $endif$
      <p class="author">
        $copyright$ $author$$if(affiliation)$, $affiliation$ $endif$
      </p>
    </address>
    $endif$
    <script>
      var lazyLoadInstance = new LazyLoad({
        elements_selector: "img, video, iframe"
      });
    </script>
  </body>
  </html>
